(()=>{const e=document,t=(e.getElementById("headerslot"),e.getElementById("header")),n=[];let r="Untitled";const l=e.getElementById("tasktable"),a=(new Date).toISOString().substr(0,10);document.querySelector("#taskdate").value=a;const s=()=>{const l=prompt("Rename project:").trim();if(null==l)return void console.log("no project name entered, aborting rename");t.innerHTML=`${l}<span class="material-symbols-outlined" id='projrenamer'>edit_square</span>`;const a=e.getElementById(r);a.innerHTML=l,a.setAttribute("id",l),n.filter((e=>{e.project==r&&(e.project=l)})),r=l,o()};let o=()=>{e.getElementById("projrenamer").addEventListener("click",s)},i=e=>{n.filter((e=>e.project==r));let t=n.findIndex((t=>t.task==e.target.id));n.splice(t,1),c()};const d=t=>{const n=l.insertRow(0),r=n.insertCell(0),a=n.insertCell(1),s=n.insertCell(2);r.textContent=t.task,a.innerHTML=t.date;let o=e.createElement("span");s.appendChild(o),o.innerHTML="X",o.setAttribute("id",`${t.task}`),o.addEventListener("click",i)},c=()=>{l.innerHTML="",n.filter((e=>e.project==r)).forEach(d)},m=e=>{r=e.target.id,t.innerHTML=`${r}<span class="material-symbols-outlined" id='projrenamer'>edit_square</span>`,p(),c(),o()};let p=()=>{document.querySelectorAll("li").forEach((e=>{e.classList.remove("activeproj")})),e.getElementById(r).classList.add("activeproj")};e.getElementById("newprojbtn").addEventListener("click",(()=>{const n=prompt("Project name:")?.trim()??"";if(null==n||""==n)return void console.log("no name entered for new project; aborting new project");t.innerHTML=`${n}<span class="material-symbols-outlined" id='projrenamer'>edit_square</span>`,o();const l=e.createElement("li");projectlist.appendChild(l),l.setAttribute("id",n),l.addEventListener("click",m),l.innerHTML=`${n} <span class="material-symbols-outlined delprojbtn">delete</span>`,r=n,p(),c()})),e.getElementById("addbtn").addEventListener("click",(t=>{t.preventDefault(),1!=(()=>{if(""==document.getElementById("taskname").value.trim())return console.log("empty input, no task added"),!0})()&&((()=>{const e={task:document.getElementById("taskname").value.trim(),date:document.getElementById("taskdate").value,project:r};n.push(e),c(),console.log(n)})(),e.querySelector("form").reset(),document.querySelector("#taskdate").value=a)})),o(),e.getElementById("Untitled").addEventListener("click",m)})();